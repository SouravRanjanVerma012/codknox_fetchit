<div class="min-h-screen bg-gray-50">
    <div class="bg-white shadow-sm border-b mb-8">
      <div class="flex items-center justify-between px-6 py-4">
        <h1 class="font-semibold text-xl">List Of Orders</h1>
      </div>
    </div>
  
    <div class="max-w-7xl mx-auto px-4 py-4">
      <form [formGroup]="filterForm" class="flex flex-wrap gap-4 mb-6 items-center">
        <select formControlName="status" class="flex-auto rounded border border-gray-300 px-3 py-1 w-36">
          <option value="All">All</option>
          <option value="DELIVERED">Delivered</option>
          <option value="REJECTED">Rejected</option>
        </select>
        <input formControlName="orderNo" placeholder="Enter Order No." class="flex-auto border border-gray-300 rounded px-3 py-1 w-44" />
        <input formControlName="mobileUser" placeholder="Enter Mobile/User-Name" class="flex-auto border border-gray-300 rounded px-3 py-1 w-44" />
        <input formControlName="from" type="date" class="flex-auto border border-gray-300 rounded px-3 py-1 w-40" />
        <input formControlName="to" type="date" class="flex-auto border border-gray-300 rounded px-3 py-1 w-40" />
        <button type="button" (click)="applyFilters()" class="rounded-full border border-blue-300 p-2 text-blue-600 hover:bg-blue-100 cursor-pointer">
          <i class="fas fa-search"></i>
        </button>
      </form>
  
      <div class="overflow-x-auto border border-gray-200 rounded shadow-lg">
        <table class="min-w-full text-left divide-y divide-gray-200">
          <thead>
            <tr class="bg-gray-50 text-gray-500 font-semibold">
              <th class="px-4 py-2">Order No.</th>
              <th class="px-4 py-2">Vendor Name</th>
              <th class="px-4 py-2">User Name</th>
              <th class="px-4 py-2">User Address</th>
              <th class="px-4 py-2">Creation Date</th>
              <th class="px-4 py-2">Order Type</th>
              <th class="px-4 py-2">User Mobile</th>
              <th class="px-4 py-2">Payment Mode</th>
              <th class="px-4 py-2">Reference ID</th>
              <th class="px-4 py-2">Order Status</th>
              <th class="px-4 py-2">Driver Assigned</th>
              <th class="px-4 py-2">Cancel Driver</th>
              <th class="px-4 py-2">Action</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let o of filtered" class="border-b-2 border-red-300">
              <td class="px-4 py-2">{{ o.orderNo }}</td>
              <td class="px-4 py-2">{{ o.vendorName }}</td>
              <td class="px-4 py-2">{{ o.userName }}</td>
              <td class="px-4 py-2">{{ o.userAddress }}</td>
              <td class="px-4 py-2">{{ formatDate(o.creationDate) }}</td>
              <td class="px-4 py-2">{{ o.orderType }}</td>
              <td class="px-4 py-2">{{ o.userMobile }}</td>
              <td class="px-4 py-2">{{ o.paymentMode }}</td>
              <td class="px-4 py-2">{{ o.referenceId }}</td>
              <td class="px-4 py-2">{{ o.orderStatus }}</td>
              <td class="px-4 py-2">{{ o.driverAssigned }}</td>
              <td class="px-4 py-2">{{ o.cancelDriver }}</td>
              <td class="px-4 py-2">
                <button class="bg-blue-600 text-white px-4 py-1 rounded hover:bg-blue-700 cursor-pointer" (click)="openDetail(o) ">
                  Order Detail
                </button>
              </td>
            </tr>
            <tr *ngIf="filtered.length === 0">
              <td colspan="13" class="text-center py-8 text-gray-400">No orders found</td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
  
    <!-- Order Detail Modal -->
    <div *ngIf="showDetailModal && modalOrder" class="fixed inset-0 z-50   bg-gray-300 bg-opacity-50 flex items-center justify-center ">
      <div class="bg-white rounded-xl p-8 w-11/12 max-w-6xl shadow-lg relative overflow-x-auto max-h-[95vh]">
        <div class="flex justify-between">
          <div class="w-2/3">
            <div class="text-2xl font-semibold">{{ modalOrder.vendorName }}</div>
            <div class="text-gray-700 text-sm mt-2">{{ modalOrder.vendorAddress }}</div>
          </div>
          <div class="w-1/3 text-right">
            <div class="text-2xl font-semibold">{{ modalOrder.userName }}</div>
            <div class="text-gray-700 text-sm mt-2">
              {{ modalOrder.userAddress }}<br>
              {{ modalOrder.userEmail ? modalOrder.userEmail + ',' : '' }} {{ modalOrder.userMobile }}
            </div>
          </div>
        </div>
        <div class="flex items-center mt-2 justify-between">
          <div class="font-semibold text-sm text-gray-600">#{{ modalOrder.orderNo }}</div>
          <div class="font-semibold text-sm text-gray-600">Order Status: {{ modalOrder.orderStatus }}</div>
          <div class="text-right">
            <button (click)="openMap()" class="bg-blue-100 px-3 py-1 text-blue-700 rounded hover:bg-blue-200 font-bold cursor-pointer">View On Map</button>
          </div>
        </div>
        <div class="font-bold bg-black text-white text-center rounded mt-6">Product Title</div>
        <table class="w-full mt-1 mb-2 text-sm">
          <tr class="font-bold">
            <td class="w-1/3 text-center bg-black text-white py-2">Product Title</td>
            <td class="w-1/6 text-center bg-black text-white py-2">Quantity</td>
            <td class="w-1/6 text-center bg-black text-white py-2">Product Price</td>
            <td class="w-1/3 text-center bg-black text-white py-2">Total Product Price</td>
          </tr>
          <tr *ngFor="let p of modalOrder.products">
            <td class="text-center py-2">{{ p.title }}</td>
            <td class="text-center py-2">{{ p.quantity }}</td>
            <td class="text-center py-2">₹ {{ p.price.toFixed(2) }}</td>
            <td class="text-center py-2">₹ {{ p.total.toFixed(2) }}</td>
          </tr>
          <tr *ngIf="!modalOrder.products.length">
            <td colspan="4" class="text-center py-4 text-gray-400">No products</td>
          </tr>
        </table>
        <div class="font-bold bg-black text-white text-center rounded mt-2">Summary</div>
        <table class="w-full text-sm mt-1">
          <tr class="font-bold">
            <td class="text-center">Sub Total</td>
            <td class="text-center">Coupon Discount</td>
            <td class="text-center">Coupon Type</td>
            <td class="text-center">Referral Discount</td>
            <td class="text-center">Delivery Fees</td>
            <td class="text-center">GST Charges(0%)</td>
            <td class="text-center">Packaging Charges</td>
            <td class="text-center">Total Price</td>
            <td class="text-center">Admin Share</td>
          </tr>
          <tr>
            <td class="text-center">₹ {{ modalOrder.summary.subTotal.toFixed(2) }}</td>
            <td class="text-center">{{ modalOrder.summary.couponDiscount }}</td>
            <td class="text-center">{{ modalOrder.summary.couponType }}</td>
            <td class="text-center">{{ modalOrder.summary.referralDiscount }}</td>
            <td class="text-center">{{ modalOrder.summary.deliveryFees }}</td>
            <td class="text-center">{{ modalOrder.summary.gstCharges }}</td>
            <td class="text-center">{{ modalOrder.summary.packagingCharges }}</td>
            <td class="text-center">₹ {{ modalOrder.summary.totalPrice.toFixed(2) }}</td>
            <td class="text-center">₹ {{ modalOrder.summary.adminShare.toFixed(2) }}</td>
          </tr>
        </table>
        <div class="flex justify-end pt-6">
          <button (click)="closeDetail()" type="button" class="border border-red-400 px-5 py-2 rounded text-red-600 hover:bg-red-100 cursor-pointer">Close</button>
        </div>
      </div>
    </div>
  
    <!-- View On Map Modal -->
    <div *ngIf="showMapModal" class="fixed inset-0 z-50 bg-gray-300 bg-opacity-60 flex items-center justify-center">
      <div class="bg-white w-[600px] max-w-full rounded-xl shadow-lg p-8 relative">
        <div class="font-bold text-lg mb-4">Order Map Data</div>
        <!-- Replace this section with a real map or directions if desired -->
        <div class="mb-2">
          <strong>Vendor:</strong> {{ modalOrder?.vendorName }}<br />
          <strong>Vendor Address:</strong> {{ modalOrder?.vendorAddress }}<br /><br />
          <strong>User:</strong> {{ modalOrder?.userName }}<br />
          <strong>User Address:</strong> {{ modalOrder?.userAddress }}
        </div>
        <div class="text-gray-500 mb-4">[Map would be shown here. You can embed Google Maps or use a static image.]</div>
        <div class="flex justify-end">
          <button (click)="closeMap()" class="border border-red-400 px-5 py-2 rounded text-red-600 hover:bg-red-100 cursor-pointer">Close</button>
        </div>
      </div>
    </div>
  </div>
  