<div class="min-h-screen bg-gray-50">
    <div class="bg-white shadow-sm border-b px-6 py-4 flex justify-between items-center">
      <h1 class="text-xl font-semibold">Category List</h1>
      <button class="bg-red-600 text-white px-6 py-2 rounded hover:bg-red-700 cursor-pointer" (click)="openAddModal()">
        <i class="fas fa-plus mr-2"></i> Add
      </button>
    </div>
  
    <div class="mx-auto max-w-6xl mt-6 bg-white shadow rounded p-4">
      <table class="w-full table-auto border-collapse text-center">
        <thead class="border-b-2 border-gray-300">
          <tr>
            <th class="p-3">Banner</th>
            <th class="p-3">Category</th>
            <th class="p-3">Icon</th>
            <th class="p-3">Actions</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let category of categories" class="border-b border-red-300">
            <td class="p-2">
              <img
                [src]="category.banner"
                alt="{{ category.name }} Banner"
                class="mx-auto w-36 h-20 object-cover cursor-pointer"
                (click)="showImage(category.banner, true)"
              />
            </td>
            <td class="p-2 font-bold">{{ category.name }}</td>
            <td class="p-2">
              <img
                [src]="category.icon"
                alt="{{ category.name }} Icon"
                class="mx-auto w-16 h-16 object-contain cursor-pointer"
                (click)="showImage(category.icon)"
              />
            </td>
            <td class="p-2 space-x-2">
              <button (click)="openEditModal(category)" title="Edit" class="text-blue-600 hover:text-blue-800 cursor-pointer">
                <i class="fas fa-edit"></i>
              </button>
              <button (click)="confirmDelete(category)" title="Delete" class="text-red-600 hover:text-red-800 cursor-pointer">
                <i class="fas fa-trash"></i>
              </button>
            </td>
          </tr>
          <tr *ngIf="categories.length === 0">
            <td colspan="4" class="p-6 text-center text-gray-500">
              No categories found.
            </td>
          </tr>
        </tbody>
      </table>
    </div>
  
    <!-- Add/Edit Modal -->
    <div *ngIf="showModal" class="fixed inset-0 bg-gray-300 bg-opacity-50 flex justify-center items-center z-50">
      <div class="bg-white rounded-lg shadow-lg w-full max-w-md p-6 relative overflow-auto max-h-screen">
        <div class="flex justify-between items-center mb-6">
          <h2 class="text-xl font-bold">{{ isEdit ? 'Edit Store Category' : 'Add Store Category' }}</h2>
          <button (click)="closeModal()" class="text-gray-600 hover:text-gray-900 text-xl font-bold cursor-pointer">&times;</button>
        </div>
        <form [formGroup]="form" (ngSubmit)="submitForm()" novalidate>
          <label class="block mb-2 font-semibold">Category Name</label>
          <input type="text" formControlName="name" class="w-full mb-3 p-2 border border-gray-300 rounded" />
          <div class="text-red-600 mb-3 text-sm" *ngIf="form.get('name')?.invalid && form.get('name')?.touched">
            Category Name is required.
          </div>
  
          <label class="block mb-2 font-semibold">Category Icon</label>
          <div class="mb-3 border border-gray-300 rounded p-2 flex justify-center items-center cursor-pointer bg-gray-50">
            <ng-container *ngIf="form.get('icon')?.value; else iconUpload">
              <img [src]="form.get('icon')?.value" alt="Category Icon" class="h-16 object-contain" />
              <button type="button" class="ml-2 text-red-600 cursor-pointer" (click)="form.get('icon')?.setValue('')">Remove</button>
            </ng-container>
            <ng-template #iconUpload>
              <label class="w-full text-center text-gray-400 cursor-pointer">
                <i class="fas fa-upload fa-2x"></i>
                <input type="file" accept="image/*" (change)="onIconFileChange($event)" hidden />
              </label>
            </ng-template>
          </div>
          <div class="text-red-600 mb-3 text-sm" *ngIf="form.get('icon')?.invalid && form.get('icon')?.touched">
            Category Icon is required.
          </div>
  
          <label class="block mb-2 font-semibold">Category Banner</label>
          <div class="mb-3 border border-gray-300 rounded p-2 flex justify-center items-center cursor-pointer bg-gray-50">
            <ng-container *ngIf="form.get('banner')?.value; else bannerUpload">
              <img [src]="form.get('banner')?.value" alt="Category Banner" class="h-20 object-contain" />
              <button type="button" class="ml-2 text-red-600 cursor-pointer" (click)="form.get('banner')?.setValue('')">Remove</button>
            </ng-container>
            <ng-template #bannerUpload>
              <label class="w-full text-center text-gray-400 cursor-pointer">
                <i class="fas fa-upload fa-2x"></i>
                <input type="file" accept="image/*" (change)="onBannerFileChange($event)" hidden />
              </label>
            </ng-template>
          </div>
          <div class="text-red-600 mb-3 text-sm" *ngIf="form.get('banner')?.invalid && form.get('banner')?.touched">
            Category Banner is required.
          </div>
  
          <div class="flex justify-end space-x-4 mt-6">
            <button type="button" (click)="closeModal()" class="px-4 py-2 border border-gray-300 rounded hover:bg-gray-100 cursor-pointer">
              Cancel
            </button>
            <button type="submit" [disabled]="form.invalid" class="px-6 py-2 bg-green-600 text-white rounded hover:bg-green-700 cursor-pointer">
              {{ isEdit ? 'Update' : 'Save' }}
            </button>
          </div>
        </form>
      </div>
    </div>
  
    <!-- Image Preview Modal -->
    <div *ngIf="showImageModal" class="fixed inset-0 bg-gray-300 bg-opacity-70 flex justify-center items-center z-50">
      <div class="bg-white p-4 rounded shadow-lg max-w-xl max-h-[80vh] overflow-auto">
        <img [src]="imageToView" [alt]="isBannerView ? 'Category Banner' : 'Category Icon'" class="max-w-full max-h-96 object-contain" />
        <div class="mt-4 flex justify-center">
          <button (click)="closeImageModal()" class="px-6 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 cursor-pointer">OK</button>
        </div>
      </div>
    </div>
  
    <!-- Delete Confirmation Modal -->
    <div *ngIf="showDeleteModal" class="fixed inset-0 bg-gray-300 bg-opacity-70 flex justify-center items-center z-50">
      <div class="bg-white rounded shadow-lg p-6 max-w-sm">
        <p class="mb-4">Are you sure you want to delete category "<strong>{{ deletingCategory?.name }}</strong>"?</p>
        <div class="flex justify-end space-x-4">
          <button (click)="closeDeleteModal()" class="px-4 py-2 border rounded hover:bg-gray-200 cursor-pointer">Cancel</button>
          <button (click)="performDelete()" class="px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700 cursor-pointer">Delete</button>
        </div>
      </div>
    </div>
  